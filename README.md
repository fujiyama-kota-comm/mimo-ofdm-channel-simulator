# üì° **mimo-ofdm-channel-simulator**

![Build](https://github.com/fujiyama-kota-comm/mimo-ofdm-channel-simulator/actions/workflows/c-cpp.yml/badge.svg)
![License](https://img.shields.io/badge/license-MIT-blue.svg)
![Version](https://img.shields.io/github/v/tag/fujiyama-kota-comm/mimo-ofdm-channel-simulator)

A clean and modular C implementation of
**MIMO-OFDM downlink channel simulation**, including:

- 3GPP **TDL-A/B/C** fading models
- UE-speed-dependent **Jakes Doppler**
- OFDM modulation (IFFT/FFT + CP)
- Multi-QAM (BPSK/QPSK/16QAM/64QAM/256QAM)
- **ZF / MMSE MIMO equalization**
- BER evaluation for **1√ó1 ÔΩû 2√ó2 MIMO**

Designed for **5G/6G physical-layer research**, algorithm benchmarking, and education.

---

## üìò Overview

This repository provides a self-contained simulator for a
**3GPP-style downlink MIMO-OFDM PHY**, implementing:

- 1√ó1, 2√ó1, 1√ó2, 2√ó2 MIMO spatial multiplexing
- Frequency-selective **TDL-A/B/C channels**
- Time-varying fading using **Jakes-like Doppler**
- Linear MIMO equalizers (**ZF / MMSE**)
- Gray-mapped multi-QAM
- Full BER pipeline
  *(bit generation ‚Üí OFDM ‚Üí channel ‚Üí equalizer ‚Üí demod ‚Üí BER)*

Suitable for:

- Wireless communications research
- Evaluation of MIMO algorithms
- Fading channel modeling
- Lightweight PHY simulation without MATLAB or heavy frameworks

---

## üìÅ Project Structure

```
mimo-ofdm-channel-simulator
‚îú‚îÄ‚îÄ src/                 # OFDM, TDL channel, MIMO equalizer, modulator
‚îú‚îÄ‚îÄ include/             # Public headers
‚îú‚îÄ‚îÄ mains/               # Main BER simulation (MIMO)
‚îú‚îÄ‚îÄ results/             # BER CSV files
‚îú‚îÄ‚îÄ images/              # Plots generated by python scripts
‚îú‚îÄ‚îÄ python/              # Plotting scripts
‚îú‚îÄ‚îÄ Makefile             # Build rules
‚îî‚îÄ‚îÄ README.md            # Documentation
```

---

## üìë Features

### ‚úî OFDM Processing
- Nfft = 256 (easily configurable)
- CP insertion / removal
- FFT / IFFT wrappers
- Compatible with 30 kHz NR-like numerology

### ‚úî 3GPP TDL Fading Channel
- Profiles: **TDL-A / TDL-B / TDL-C**
- Rayleigh fading per tap
- Jakes-like Doppler time evolution
- Adjustable RMS delay spread
- Independent channels for each MIMO link

### ‚úî Multi-QAM Modem
- BPSK / QPSK / 16QAM / 64QAM / 256QAM
- Gray mapping
- Es = 1 normalization

### ‚úî MIMO Equalizers
- **ZF**
- **MMSE**
- Supports 1√ó1, 2√ó1, 1√ó2, 2√ó2
- Per-subcarrier equalization using frequency-domain H[k]

### ‚úî Perfect CSI
Frequency-domain channel **H[k]** is computed directly from TDL taps
(ideal CSI for algorithm evaluation).

### ‚úî BER Simulation

Main simulation program:

```
mains/mimo_ofdm_ber.c
```

Generates BER CSV:

```
results/mimo_ofdm_ber_data.csv
```

Plotting:

```
python python/plot_mimo_ofdm_ber.py
```

---

## üõ† Build Instructions

### Requirements
- GCC / Clang
- make
- Linux / macOS / WSL / MinGW
- Python3 + matplotlib (optional for plotting)

### Build

```sh
make
```

Binary:

```
bin/mimo_ofdm_ber
```

Run:

```sh
make run
```

Clean:

```sh
make clean
```

---

## üöÄ Usage Example

Run full BER simulation:

```sh
./bin/mimo_ofdm_ber
```

Output CSV:

```
results/mimo_ofdm_ber_data.csv
```

Plot BER curves:

```sh
python python/plot_mimo_ofdm_ber.py
```

---

## üìâ BER Performance Example

![BER graph](images/mimo_ofdm_ber_graph.svg)

---

## üìê Simulation Parameters (for BER Graph)

The BER result shown above was generated using the following MIMO-OFDM
and 3GPP TDL channel parameters:

### **OFDM Parameters**
| Parameter | Value | Description |
|-----------|--------|-------------|
| `Nfft` | **256** | Number of OFDM subcarriers (FFT size) |
| `SCS_HZ` | **30 kHz** | Subcarrier spacing (NR-like numerology) |
| `fs` | **7.68 MHz** | Sampling rate (= Nfft √ó SCS) |
| CP | Normal CP | CP length chosen to provide sufficient margin over the maximum delay spread of the TDL profile (avoids ISI for TDL-A/B/C with 256-point FFT) |


---

### **MIMO Configuration**
| Parameter | Value | Description |
|-----------|--------|-------------|
| `Ntx` | **2** | Number of transmit antennas |
| `Nrx` | **2** | Number of receive antennas |
| MIMO mode | Spatial multiplexing | One QAM symbol per Tx antenna per subcarrier |

---

### **Channel Model (3GPP TDL)**
| Parameter | Value | Description |
|-----------|--------|-------------|
| `tdl_type` | **TDL-A** | 3GPP frequency-selective delay profile |
| Carrier frequency | **3.5 GHz** | mid-band FR1 channel |
| `speed_kmh` | **30 km/h** | UE mobility ‚Üí Jakes Doppler applied |
| `DS_desired_ns` | **363 ns** | RMS delay spread scaling (urban NLOS-like) |

The frequency-domain channel **H[k]** is computed from the full TDL taps
and evolves over time using a Jakes-like Doppler filter.
This yields a realistic 5G-NR-compatible fading environment for BER evaluation.

---

## üìÇ Source Code Structure

### src/
| File | Description |
|------|-------------|
| `ofdm.c` | OFDM modulation/demodulation |
| `modulator.c` | QAM mapping/demapping |
| `channel_tdl.c` | 3GPP TDL fading + Jakes Doppler |
| `mimo.c` | Matrix ops + ZF/MMSE equalization |

### include/
| File | Description |
|------|-------------|
| `ofdm.h` | OFDM API |
| `modulator.h` | QAM modem API |
| `channel_tdl.h` | TDL fading model |
| `mimo.h` | MIMO equalizer/matrix utilities |

### mains/
| File | Description |
|------|-------------|
| `mimo_ofdm_ber.c` | Main BER simulation program |

---

## üîí Confidentiality Notice

All source code in this repository was developed independently
using only **public 3GPP specifications** and academic knowledge.
No proprietary or confidential information is used.

---

## üìú License

Released under the **MIT License**.
Free for research, education, and commercial use.

---

## ü§ù Contributing

Pull requests and feature suggestions are welcome.
For large changes, please open an issue first.

---

## ‚≠ê Acknowledgements

Developed as part of research on
**MIMO-OFDM, fading channels, and physical-layer signal processing**.

If you find this project useful, please consider giving it a ‚≠ê!

